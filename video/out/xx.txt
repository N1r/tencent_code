ffmpeg -i target_video.mp4 -c:v libx264 -profile:v $(ffprobe -v error -select_streams v:0 -show_entries stream=profile -of csv=p=0 reference_video.mp4) -level $(ffprobe -v error -select_streams v:0 -show_entries stream=level -of csv=p=0 reference_video.mp4) -pix_fmt $(ffprobe -v error -select_streams v:0 -show_entries stream=pix_fmt -of csv=p=0 reference_video.mp4) -r $(ffprobe -v error -select_streams v:0 -show_entries stream=r_frame_rate -of csv=p=0 reference_video.mp4) -s $(ffprobe -v error -select_streams v:0 -show_entries stream=width,height -of csv=p=0 reference_video.mp4 | tr ',' 'x') -c:a $(ffprobe -v error -select_streams a:0 -show_entries stream=codec_name -of csv=p=0 reference_video.mp4) -ar $(ffprobe -v error -select_streams a:0 -show_entries stream=sample_rate -of csv=p=0 reference_video.mp4) -ac $(ffprobe -v error -select_streams a:0 -show_entries stream=channels -of csv=p=0 reference_video.mp4) output.mp4